--- a/net/minecraft/server/PlayerAdvancements.java
+++ b/net/minecraft/server/PlayerAdvancements.java
@@ -44,11 +_,13 @@
 import net.minecraft.server.players.PlayerList;
 import net.minecraft.util.datafix.DataFixTypes;
 import net.minecraft.world.level.GameRules;
+import org.bukkit.Bukkit;
+import org.bukkit.event.player.PlayerAdvancementDoneEvent;
 import org.slf4j.Logger;
 
 public class PlayerAdvancements {
     private static final Logger LOGGER = LogUtils.getLogger();
-    private static final Gson GSON = new GsonBuilder().setPrettyPrinting().create();
+    private static final Gson GSON = (new GsonBuilder()).create(); // Paper - Remove pretty printing from advancements
     private final PlayerList playerList;
     private final Path playerSavePath;
     private AdvancementTree tree;
@@ -129,6 +_,7 @@
     }
 
     public void save() {
+        if (org.spigotmc.SpigotConfig.disableAdvancementSaving) return; // Spigot
         JsonElement jsonelement = this.codec.encodeStart(JsonOps.INSTANCE, this.asData()).getOrThrow();
 
         try {
@@ -146,6 +_,7 @@
         p_301198_.forEach((p_300732_, p_300733_) -> {
             AdvancementHolder advancementholder = p_301166_.get(p_300732_);
             if (advancementholder == null) {
+                if (!p_300732_.getNamespace().equals("minecraft")) return; // CraftBukkit
                 LOGGER.warn("Ignored advancement '{}' in progress file {} - it doesn't exist anymore?", p_300732_, this.playerSavePath);
             } else {
                 this.startProgress(advancementholder, p_300733_);
@@ -166,19 +_,40 @@
     }
 
     public boolean award(AdvancementHolder p_300979_, String p_135990_) {
+        // Forge: don't grant advancements for fake players
+        if (this.player instanceof net.neoforged.neoforge.common.util.FakePlayer) return false;
         boolean flag = false;
         AdvancementProgress advancementprogress = this.getOrStartProgress(p_300979_);
         boolean flag1 = advancementprogress.isDone();
         if (advancementprogress.grantProgress(p_135990_)) {
+            // Paper start - Add PlayerAdvancementCriterionGrantEvent
+            if (!new com.destroystokyo.paper.event.player.PlayerAdvancementCriterionGrantEvent(this.player.getBukkitEntity(), p_300979_.toBukkit(), p_135990_).callEvent()) {
+                advancementprogress.revokeProgress(p_135990_);
+                return false;
+            }
+            // Paper end - Add PlayerAdvancementCriterionGrantEvent
             this.unregisterListeners(p_300979_);
             this.progressChanged.add(p_300979_);
             flag = true;
+            net.neoforged.neoforge.event.EventHooks.onAdvancementProgressedEvent(this.player, p_300979_, advancementprogress, p_135990_, net.neoforged.neoforge.event.entity.player.AdvancementEvent.AdvancementProgressEvent.ProgressType.GRANT);
             if (!flag1 && advancementprogress.isDone()) {
+                // Paper start - Add Adventure message to PlayerAdvancementDoneEvent
+                final net.kyori.adventure.text.Component message = p_300979_.value().display().flatMap(info -> {
+                    return java.util.Optional.ofNullable(
+                            info.shouldAnnounceChat() ? io.papermc.paper.adventure.PaperAdventure.asAdventure(info.getType().createAnnouncement(p_300979_, this.player)) : null
+                    );
+                }).orElse(null);
+                final org.bukkit.event.player.PlayerAdvancementDoneEvent event = new org.bukkit.event.player.PlayerAdvancementDoneEvent(this.player.getBukkitEntity(), p_300979_.toBukkit(), message);
+                this.player.level().getCraftServer().getPluginManager().callEvent(event); // CraftBukkit
+                // Paper end
                 p_300979_.value().rewards().grant(this.player);
                 p_300979_.value().display().ifPresent(p_352686_ -> {
-                    if (p_352686_.shouldAnnounceChat() && this.player.level().getGameRules().getBoolean(GameRules.RULE_ANNOUNCE_ADVANCEMENTS)) {
-                        this.playerList.broadcastSystemMessage(p_352686_.getType().createAnnouncement(p_300979_, this.player), false);
+                    // Paper start - Add Adventure message to PlayerAdvancementDoneEvent
+                    if (event.message() != null && this.player.level().getGameRules().getBoolean(GameRules.RULE_ANNOUNCE_ADVANCEMENTS)) {
+                        this.playerList.broadcastSystemMessage(io.papermc.paper.adventure.PaperAdventure.asVanilla(event.message()), false);
+                        // Paper end
                     }
+                    net.neoforged.neoforge.event.EventHooks.onAdvancementEarnedEvent(this.player, p_300979_);
                 });
             }
         }
@@ -198,6 +_,7 @@
             this.registerListeners(p_301073_);
             this.progressChanged.add(p_301073_);
             flag = true;
+            net.neoforged.neoforge.event.EventHooks.onAdvancementProgressedEvent(this.player, p_301073_, advancementprogress, p_136000_, net.neoforged.neoforge.event.entity.player.AdvancementEvent.AdvancementProgressEvent.ProgressType.REVOKE);
         }
 
         if (flag1 && !advancementprogress.isDone()) {
