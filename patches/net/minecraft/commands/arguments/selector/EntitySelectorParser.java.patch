--- a/net/minecraft/commands/arguments/selector/EntitySelectorParser.java
+++ b/net/minecraft/commands/arguments/selector/EntitySelectorParser.java
@@ -12,6 +_,7 @@
 import java.util.List;
 import java.util.UUID;
 import java.util.concurrent.CompletableFuture;
+import java.util.concurrent.atomic.AtomicBoolean;
 import java.util.function.BiConsumer;
 import java.util.function.BiFunction;
 import java.util.function.Consumer;
@@ -122,8 +_,9 @@
     }
 
     public static <S> boolean allowSelectors(S p_353135_) {
-        if (p_353135_ instanceof SharedSuggestionProvider sharedsuggestionprovider && sharedsuggestionprovider.hasPermission(2)) {
-            return true;
+        if (p_353135_ instanceof SharedSuggestionProvider sharedsuggestionprovider) {
+            // Paper - Fix EntityArgument permissions
+            return p_353135_ instanceof net.minecraft.commands.CommandSourceStack stack ? stack.bypassSelectorPermissions || stack.hasPermission(2, "minecraft.command.selector") : sharedsuggestionprovider.hasPermission(2);
         }
 
         return false;
@@ -204,8 +_,14 @@
         };
     }
 
+    public AtomicBoolean parseSelector$overridePermissions = new AtomicBoolean(false);
+    protected void parseSelector(boolean overridePermissions) throws CommandSyntaxException {
+        parseSelector$overridePermissions.set(overridePermissions);
+        parseSelector();
+    }
+
     protected void parseSelector() throws CommandSyntaxException {
-        this.usesSelectors = true;
+        this.usesSelectors = !parseSelector$overridePermissions.getAndSet(false);
         this.suggestions = this::suggestSelector;
         if (!this.reader.canRead()) {
             throw ERROR_MISSING_SELECTOR_TYPE.createWithContext(this.reader);
@@ -472,6 +_,12 @@
         this.order = p_121269_;
     }
 
+    public AtomicBoolean parse$overridePermissions = new AtomicBoolean(false);
+    public EntitySelector parse(boolean overridePermissions) throws CommandSyntaxException {
+        parse$overridePermissions.set(overridePermissions);
+        return parse();
+    }
+
     public EntitySelector parse() throws CommandSyntaxException {
         this.startPosition = this.reader.getCursor();
         this.suggestions = this::suggestNameOrSelector;
@@ -481,6 +_,11 @@
             }
 
             this.reader.skip();
+            EntitySelector forgeSelector = net.neoforged.neoforge.common.command.EntitySelectorManager.parseSelector(this);
+            if (forgeSelector != null)
+                return forgeSelector;
+
+            parseSelector$overridePermissions.set(parse$overridePermissions.getAndSet(false));
             this.parseSelector();
         } else {
             this.parseNameOrUUID();
@@ -497,6 +_,7 @@
         p_121248_.suggest("@s", Component.translatable("argument.entity.selector.self"));
         p_121248_.suggest("@e", Component.translatable("argument.entity.selector.allEntities"));
         p_121248_.suggest("@n", Component.translatable("argument.entity.selector.nearestEntity"));
+        net.neoforged.neoforge.common.command.EntitySelectorManager.fillSelectorSuggestions(p_121248_);
     }
 
     private CompletableFuture<Suggestions> suggestNameOrSelector(SuggestionsBuilder p_121287_, Consumer<SuggestionsBuilder> p_121288_) {
