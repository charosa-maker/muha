--- a/net/minecraft/world/entity/Leashable.java
+++ b/net/minecraft/world/entity/Leashable.java
@@ -11,6 +_,7 @@
 import net.minecraft.server.level.ServerLevel;
 import net.minecraft.world.entity.decoration.LeashFenceKnotEntity;
 import net.minecraft.world.item.Items;
+import org.bukkit.event.entity.EntityUnleashEvent;
 
 public interface Leashable {
     String LEASH_TAG = "leash";
@@ -62,6 +_,12 @@
     default void writeLeashData(CompoundTag p_352349_, @Nullable Leashable.LeashData p_352363_) {
         if (p_352363_ != null) {
             Either<UUID, BlockPos> either = p_352363_.delayedLeashInfo;
+            // CraftBukkit start - SPIGOT-7487: Don't save (and possible drop) leash, when the holder was removed by a plugin
+            Entity entity = p_352363_.leashHolder;
+            if (entity != null && entity.pluginRemoved) {
+                return;
+            }
+            // CraftBukkit end
             if (p_352363_.leashHolder instanceof LeashFenceKnotEntity leashfenceknotentity) {
                 either = Either.right(leashfenceknotentity.getPos());
             } else if (p_352363_.leashHolder != null) {
@@ -94,7 +_,9 @@
             }
 
             if (p_352354_.tickCount > 100) {
+                p_352354_.forceDrops = true; // CraftBukkit
                 p_352354_.spawnAtLocation(Items.LEAD);
+                p_352354_.forceDrops = false; // CraftBukkit
                 p_352354_.setLeashData(null);
             }
         }
@@ -109,7 +_,9 @@
         if (leashable$leashdata != null && leashable$leashdata.leashHolder != null) {
             p_352163_.setLeashData(null);
             if (!p_352163_.level().isClientSide && p_352272_) {
+                p_352163_.forceDrops = true; // CraftBukkit
                 p_352163_.spawnAtLocation(Items.LEAD);
+                p_352163_.forceDrops = false; // CraftBukkit
             }
 
             if (p_352286_ && p_352163_.level() instanceof ServerLevel serverlevel) {
@@ -126,7 +_,11 @@
 
         if (leashable$leashdata != null && leashable$leashdata.leashHolder != null) {
             if (!p_352082_.isAlive() || !leashable$leashdata.leashHolder.isAlive()) {
-                dropLeash(p_352082_, true, true);
+                // Paper start - Expand EntityUnleashEvent
+                final EntityUnleashEvent event = new EntityUnleashEvent(p_352082_.getBukkitEntity(), (!p_352082_.isAlive()) ? EntityUnleashEvent.UnleashReason.PLAYER_UNLEASH : EntityUnleashEvent.UnleashReason.HOLDER_GONE, !p_352082_.pluginRemoved);
+                event.callEvent();
+                dropLeash(p_352082_, true, event.isDropLeash()); // CraftBukkit - SPIGOT-7487: Don't drop leash, when the holder was removed by a plugin
+                // Paper end - Expand EntityUnleashEvent
             }
 
             Entity entity = p_352082_.getLeashHolder();
@@ -136,7 +_,7 @@
                     return;
                 }
 
-                if ((double)f > 10.0) {
+                if ((double)f > p_352082_.level().paperConfig().misc.maxLeashDistance.or(LEASH_TOO_FAR_DIST)) { // Paper - Configurable max leash distance
                     p_352082_.leashTooFarBehaviour();
                 } else if ((double)f > 6.0) {
                     p_352082_.elasticRangeLeashBehaviour(entity, f);
@@ -153,7 +_,17 @@
     }
 
     default void leashTooFarBehaviour() {
-        this.dropLeash(true, true);
+        // CraftBukkit start
+        boolean dropLeash = true; // Paper
+        if (this instanceof Entity entity) {
+            // Paper start - Expand EntityUnleashEvent
+            final EntityUnleashEvent event = new EntityUnleashEvent(entity.getBukkitEntity(), EntityUnleashEvent.UnleashReason.DISTANCE, true);
+            if (!event.callEvent()) return;
+            dropLeash = event.isDropLeash();
+            // Paper end - Expand EntityUnleashEvent
+        }
+        // CraftBukkit end
+        this.dropLeash(true, dropLeash); // Paper
     }
 
     default void closeRangeLeashBehaviour(Entity p_352073_) {
